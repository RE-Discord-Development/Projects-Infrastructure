global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
  - job_name: 'cAdvisor'
    static_configs:
      - targets: ['prometheus-cadvisor:8080']
  - job_name: 'traefik'
    static_configs:
      - targets: ['traefik:8082']
  - job_name: 'grafana'
    static_configs:
      - targets: ['grafana:3000']
  - job_name: 'grafana-renderer'
    static_configs:
      - targets: ['grafana-renderer:8081']
  - job_name: 'blackbox'
    metrics_path: /probe
    params:
      module: ['http_prometheus']
    static_configs:
      - targets:
        - https://www.essex.ac.uk
        - https://moodle.essex.ac.uk
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: prometheus-blackbox:9115 
  - job_name: 'feds-check'
    metrics_path: /probe
    params:
      module: ['http_essex_feds_prober']
    static_configs:
      - targets:
        - https://feds.essex.ac.uk/adfs/ls/?wa=wsignin1.0&wtrealm=urn:federation:MicrosoftOnline
        - https://email.essex.ac.uk
        - https://faser.essex.ac.uk
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: prometheus-blackbox:9115
  - job_name: 'feds-dns-check'
    metrics_path: /probe
    params:
      module: ['dns_essex_feds_prober']
    static_configs:
      - targets:
        - dns0.essex.ac.uk
        - dns1.essex.ac.uk
        - dns2.essex.ac.uk
        - dns3.essex.ac.uk
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: prometheus-blackbox:9115

